{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/user/Downloads/pdf-csv-mapper-angular-php/pdf-csv-mapper-angular-php/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { environment } from '../../environments/environment';\nimport * as pdfjsLib from 'pdfjs-dist';\nimport Papa from 'papaparse';\nimport * as XLSX from 'xlsx';\nimport Tesseract from 'tesseract.js';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nfunction PdfCsvMapperComponent_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 23);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"ngClass\", ctx_r0.statusType);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(ctx_r0.statusMessage);\n  }\n}\nfunction PdfCsvMapperComponent_div_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 24);\n    i0.ɵɵelement(1, \"div\", 25);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵstyleProp(\"width\", ctx_r0.pdfProgress, \"%\");\n  }\n}\nfunction PdfCsvMapperComponent_img_35_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 26);\n  }\n  if (rf & 2) {\n    const src_r2 = ctx.$implicit;\n    i0.ɵɵproperty(\"src\", src_r2, i0.ɵɵsanitizeUrl);\n  }\n}\nfunction PdfCsvMapperComponent_table_40_th_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const h_r3 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(h_r3);\n  }\n}\nfunction PdfCsvMapperComponent_table_40_tr_5_td_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const c_r4 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(c_r4);\n  }\n}\nfunction PdfCsvMapperComponent_table_40_tr_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\");\n    i0.ɵɵtemplate(1, PdfCsvMapperComponent_table_40_tr_5_td_1_Template, 2, 1, \"td\", 22);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const row_r5 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngForOf\", row_r5);\n  }\n}\nfunction PdfCsvMapperComponent_table_40_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"table\")(1, \"thead\")(2, \"tr\");\n    i0.ɵɵtemplate(3, PdfCsvMapperComponent_table_40_th_3_Template, 2, 1, \"th\", 22);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(4, \"tbody\");\n    i0.ɵɵtemplate(5, PdfCsvMapperComponent_table_40_tr_5_Template, 2, 1, \"tr\", 22);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.csvPreviewHeaders);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.csvPreviewRows);\n  }\n}\nfunction PdfCsvMapperComponent_th_51_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const md_r6 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(md_r6.header);\n  }\n}\nfunction PdfCsvMapperComponent_td_54_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const md_r7 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(md_r7.value);\n  }\n}\npdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.12.313/pdf.worker.min.js';\nexport let PdfCsvMapperComponent = /*#__PURE__*/(() => {\n  class PdfCsvMapperComponent {\n    http;\n    // UI state\n    pdfFileName = '';\n    csvFileName = '';\n    statusMessage = '';\n    statusType = '';\n    showPdfProgress = false;\n    pdfProgress = 0;\n    documentHasData = false;\n    // Data\n    pdfText = '';\n    pageImages = [];\n    csvHeaders = [];\n    csvPreviewHeaders = [];\n    csvPreviewRows = [];\n    mappedData = [];\n    constructor(http) {\n      this.http = http;\n    }\n    // ------------------- UI helpers -------------------\n    showStatusMessage(text, type = 'success') {\n      this.statusMessage = text;\n      this.statusType = type;\n      setTimeout(() => {\n        this.statusMessage = '';\n        this.statusType = '';\n      }, 5000);\n    }\n    setProgress(p) {\n      this.pdfProgress = Math.max(0, Math.min(100, p));\n    }\n    // ------------------- File handlers -------------------\n    onPdfSelected(event) {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        const input = event.target;\n        const file = input.files && input.files[0];\n        if (!file) return;\n        _this.pdfFileName = file.name;\n        _this.showPdfProgress = true; // FIXED\n        _this.setProgress(0);\n        _this.pageImages = [];\n        _this.pdfText = '';\n        // Optional: send to backend for storage (non-blocking)\n        const form = new FormData();\n        form.append('pdfFile', file);\n        _this.http.post(environment.API_BASE + '/upload.php', form).subscribe({\n          next: () => {},\n          error: () => {}\n        });\n        try {\n          const arrayBuffer = yield file.arrayBuffer();\n          const pdf = yield pdfjsLib.getDocument({\n            data: arrayBuffer\n          }).promise; // FIXED\n          let fullText = '';\n          const totalPages = pdf.numPages;\n          for (let i = 1; i <= totalPages; i++) {\n            const page = yield pdf.getPage(i);\n            const viewport = page.getViewport({\n              scale: 1.5\n            });\n            const canvas = document.createElement('canvas');\n            const context = canvas.getContext('2d');\n            canvas.height = viewport.height;\n            canvas.width = viewport.width;\n            yield page.render({\n              canvasContext: context,\n              viewport\n            }).promise;\n            const imgUrl = canvas.toDataURL();\n            _this.pageImages.push(imgUrl);\n            // Try native text\n            const textContent = yield page.getTextContent();\n            let pageText = '';\n            let lastY = null;\n            textContent.items.forEach(item => {\n              const y = item.transform[5];\n              if (lastY !== null && Math.abs(y - lastY) > 5) pageText += '\\n';\n              pageText += item.str + ' ';\n              lastY = y;\n            });\n            const needOCR = pageText.trim().length < 20;\n            if (needOCR) {\n              try {\n                const {\n                  data: {\n                    text: ocrText\n                  }\n                } = yield Tesseract.recognize(canvas, 'eng');\n                pageText = ocrText || '';\n              } catch (e) {\n                console.warn('OCR failed', e);\n              }\n            }\n            pageText = pageText.replace(/\\u00A0/g, ' ').replace(/[‐–—−-]/g, '-').replace(/[：﹕]/g, ':').replace(/\\s+\\n/g, '\\n').trim();\n            fullText += pageText + '\\n\\n';\n            _this.setProgress(i / totalPages * 100);\n          }\n          _this.pdfText = fullText;\n          _this.documentHasData = true; // FIXED\n          _this.showStatusMessage('PDF processed successfully!');\n          _this.tryAutoMap();\n        } catch (err) {\n          console.error(err);\n          _this.showStatusMessage('Error processing PDF: ' + (err?.message || err), 'error');\n        } finally {\n          _this.showPdfProgress = false; // FIXED\n        }\n      })();\n    }\n    onCsvSelected(event) {\n      var _this2 = this;\n      return _asyncToGenerator(function* () {\n        const input = event.target;\n        const file = input.files && input.files[0];\n        if (!file) return;\n        _this2.csvFileName = file.name;\n        _this2.csvHeaders = [];\n        _this2.csvPreviewHeaders = [];\n        _this2.csvPreviewRows = [];\n        // Optional: send to backend for storage (non-blocking)\n        const form = new FormData();\n        form.append('csvFile', file);\n        _this2.http.post(environment.API_BASE + '/upload.php', form).subscribe({\n          next: () => {},\n          error: () => {}\n        });\n        try {\n          if (file.name.endsWith('.csv')) {\n            _this2.processCsvFile(file);\n          } else if (file.name.endsWith('.xlsx') || file.name.endsWith('.xls')) {\n            yield _this2.processExcelFile(file);\n          } else {\n            _this2.showStatusMessage('Unsupported file type', 'error');\n          }\n        } catch (err) {\n          _this2.showStatusMessage('Error processing file: ' + (err?.message || err), 'error');\n        }\n      })();\n    }\n    processCsvFile(file) {\n      Papa.parse(file, {\n        complete: results => {\n          if (results.data.length > 0) {\n            this.csvHeaders = results.data[0].map(h => String(h || '').trim());\n            this.prepareCsvPreview(results.data);\n            this.documentHasData = true; // FIXED\n            this.showStatusMessage('CSV file loaded successfully!');\n            this.tryAutoMap();\n          } else {\n            this.showStatusMessage('CSV file is empty or invalid', 'error');\n          }\n        },\n        error: error => {\n          this.showStatusMessage('Error parsing CSV: ' + error.message, 'error');\n        },\n        header: false,\n        skipEmptyLines: 'greedy'\n      });\n    }\n    processExcelFile(file) {\n      var _this3 = this;\n      return _asyncToGenerator(function* () {\n        const arrayBuffer = yield file.arrayBuffer();\n        const data = new Uint8Array(arrayBuffer);\n        const workbook = XLSX.read(data, {\n          type: 'array'\n        });\n        const firstSheetName = workbook.SheetNames[0];\n        const worksheet = workbook.Sheets[firstSheetName];\n        const jsonData = XLSX.utils.sheet_to_json(worksheet, {\n          header: 1\n        });\n        const cleaned = jsonData.filter(r => Array.isArray(r) && r.some(c => String(c ?? '').trim() !== ''));\n        if (cleaned.length > 0) {\n          _this3.csvHeaders = cleaned[0].map(h => String(h || '').trim());\n          _this3.prepareCsvPreview(cleaned);\n          _this3.documentHasData = true; // FIXED\n          _this3.showStatusMessage('Excel file loaded successfully!');\n          _this3.tryAutoMap();\n        } else {\n          _this3.showStatusMessage('Excel file is empty or invalid', 'error');\n        }\n      })();\n    }\n    prepareCsvPreview(data) {\n      this.csvPreviewHeaders = data[0] || [];\n      const rowLimit = Math.min(data.length, 11);\n      this.csvPreviewRows = [];\n      for (let i = 1; i < rowLimit; i++) this.csvPreviewRows.push(data[i]);\n      if (data.length > 11) {\n        const more = [`... and ${data.length - 11} more rows`];\n        this.csvPreviewRows.push([more.join(' ')]);\n      }\n    }\n    // ------------------- Auto map logic -------------------\n    tryAutoMap() {\n      if (this.pdfText && this.csvHeaders.length > 0) {\n        this.autoMapData();\n      }\n    }\n    normalize(s) {\n      return String(s || '').replace(/\\u00A0/g, ' ').toLowerCase().replace(/[‐–—−-]/g, '-').replace(/[：﹕]/g, ':').replace(/[^\\p{L}\\p{N}\\s\\-()\\/&.]/gu, '').replace(/\\s+/g, ' ').trim();\n    }\n    tokenize(s) {\n      return this.normalize(s).split(/\\s+/).filter(Boolean);\n    }\n    levDist(a, b) {\n      a = this.normalize(a);\n      b = this.normalize(b);\n      const m = Array.from({\n        length: a.length + 1\n      }, (_, i) => i);\n      for (let j = 1; j <= b.length; j++) {\n        let prev = m[0],\n          cur = j;\n        m[0] = j;\n        for (let i = 1; i <= a.length; i++) {\n          const tmp = m[i];\n          m[i] = Math.min(m[i] + 1, m[i - 1] + 1, prev + (a[i - 1] === b[j - 1] ? 0 : 1));\n          prev = tmp;\n        }\n      }\n      return m[a.length];\n    }\n    jaccard(a, b) {\n      const A = new Set(this.tokenize(a));\n      const B = new Set(this.tokenize(b));\n      const inter = [...A].filter(x => B.has(x)).length;\n      const uni = new Set([...A, ...B]).size || 1;\n      return inter / uni;\n    }\n    scoreKey(csvHeader, pdfKey) {\n      const h = this.normalize(csvHeader);\n      const k = this.normalize(pdfKey);\n      if (!h || !k) return 0;\n      let score = 0;\n      if (h === k) score += 0.65;\n      if (k.includes(h) || h.includes(k)) score += 0.25;\n      score += 0.6 * this.jaccard(h, k);\n      const maxLen = Math.max(h.length, k.length) || 1;\n      const ld = this.levDist(h, k);\n      const sim = 1 - Math.min(ld / maxLen, 1);\n      score += 0.35 * sim;\n      return Math.max(0, Math.min(1, score));\n    }\n    extractKeyValuePairs(pdfLines) {\n      const pairs = [];\n      const L = pdfLines.map(l => (l ?? '').replace(/\\u00A0/g, ' ')).map(l => l.replace(/[‐–—−-]/g, '-')).map(l => l.replace(/[：﹕]/g, ':')).map(l => l.trim()).filter(Boolean);\n      const SEP = '[:=\\\\-]'; // NOTE the double escape here because it's a string for RegExp\n      for (let i = 0; i < L.length; i++) {\n        const line = L[i];\n        let m = line.match(new RegExp(`^([\\\\p{L}\\\\p{N}\\\\s()\\\\/&.\\\\-]{2,60})\\\\s*${SEP}\\\\s*(?:\\\\.+\\\\s*)?(.+)$`, 'u'));\n        if (m && m[1] && m[2]) {\n          const keyRaw = m[1].trim();\n          const valueRaw = m[2].trim();\n          pairs.push({\n            keyRaw,\n            keyNorm: this.normalize(keyRaw),\n            valueRaw\n          });\n          continue;\n        }\n        m = line.match(/^([\\p{L}\\p{N}\\s()\\/&.\\-]{2,60})[ \\t]{2,}(.{2,})$/u);\n        if (m && m[1] && m[2]) {\n          const keyRaw = m[1].trim().replace(/\\s{2,}$/, '');\n          const valueRaw = m[2].trim();\n          pairs.push({\n            keyRaw,\n            keyNorm: this.normalize(keyRaw),\n            valueRaw\n          });\n          continue;\n        }\n        m = line.match(new RegExp(`^([\\\\p{L}\\\\p{N}\\\\s()\\\\/&.\\\\-]{2,60})\\\\s*${SEP}\\\\s*$`, 'u'));\n        if (m && m[1] && i + 1 < L.length) {\n          const keyRaw = m[1].trim();\n          const valueRaw = L[i + 1].trim();\n          if (valueRaw) {\n            pairs.push({\n              keyRaw,\n              keyNorm: this.normalize(keyRaw),\n              valueRaw\n            });\n            i++;\n            continue;\n          }\n        }\n      }\n      const seen = new Set();\n      return pairs.filter(p => {\n        const k = p.keyNorm + '||' + p.valueRaw;\n        if (seen.has(k)) return false;\n        seen.add(k);\n        return true;\n      });\n    }\n    autoMapData() {\n      this.mappedData = [];\n      const pdfLines = this.pdfText.split(/\\r?\\n/);\n      const pairs = this.extractKeyValuePairs(pdfLines);\n      const keys = pairs.map(p => p.keyRaw);\n      for (const header of this.csvHeaders) {\n        let bestIdx = -1,\n          bestScore = 0;\n        for (let i = 0; i < keys.length; i++) {\n          const s = this.scoreKey(header, keys[i]);\n          if (s > bestScore) {\n            bestScore = s;\n            bestIdx = i;\n          }\n        }\n        let value = 'Not found';\n        if (bestIdx >= 0 && bestScore >= 0.45) {\n          value = pairs[bestIdx].valueRaw.trim().replace(/[|;,]+$/, '');\n        } else {\n          const escaped = String(header).replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&').replace(/\\s+/g, '\\\\s*');\n          // FIXED: double-escape \\\\s inside new RegExp string\n          const loose = new RegExp(`${escaped}\\\\s*(?:[:=\\\\-])?\\\\s*(?:\\\\.+\\\\s*)?(.+)$`, 'i');\n          for (const raw of pdfLines) {\n            const ln = (raw || '').replace(/\\u00A0/g, ' ').replace(/[‐–—−-]/g, '-').replace(/[：﹕]/g, ':');\n            const m = ln.match(loose);\n            if (m && m[1]) {\n              value = m[1].trim();\n              break;\n            }\n          }\n          if (value === 'Not found') {\n            const norm = pdfLines.map(l => this.normalize(l));\n            const reStart = new RegExp(`^${escaped}(\\\\s*[:=\\\\-]\\\\s*)?$`, 'i'); // FIXED: \\\\s*\n            for (let i = 0; i < norm.length - 1; i++) {\n              if (reStart.test(norm[i])) {\n                const nxt = (pdfLines[i + 1] || '').trim();\n                if (nxt) {\n                  value = nxt;\n                  break;\n                }\n              }\n            }\n          }\n        }\n        this.mappedData.push({\n          header,\n          value\n        });\n      }\n    }\n    downloadExcel() {\n      if (this.mappedData.length === 0) return;\n      const headers = this.mappedData.map(i => i.header);\n      const values = this.mappedData.map(i => i.value);\n      const ws = XLSX.utils.aoa_to_sheet([headers, values]);\n      const wb = XLSX.utils.book_new();\n      XLSX.utils.book_append_sheet(wb, ws, 'Mapped Data');\n      XLSX.writeFile(wb, 'Mapped_Data.xlsx');\n      this.showStatusMessage('Excel file downloaded successfully!');\n    }\n    static ɵfac = function PdfCsvMapperComponent_Factory(t) {\n      return new (t || PdfCsvMapperComponent)(i0.ɵɵdirectiveInject(i1.HttpClient));\n    };\n    static ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: PdfCsvMapperComponent,\n      selectors: [[\"app-pdf-csv-mapper\"]],\n      decls: 55,\n      vars: 17,\n      consts: [[1, \"container\"], [1, \"header\"], [\"class\", \"status-message\", 3, \"ngClass\", 4, \"ngIf\"], [1, \"upload-section\"], [1, \"upload-card\"], [\"type\", \"file\", \"id\", \"pdfFile\", \"accept\", \".pdf\", 1, \"file-input\", 3, \"change\"], [\"for\", \"pdfFile\", 1, \"upload-btn\"], [1, \"file-name\"], [\"class\", \"progress-bar\", 4, \"ngIf\"], [\"type\", \"file\", \"id\", \"csvFile\", \"accept\", \".csv,.xlsx,.xls\", 1, \"file-input\", 3, \"change\"], [\"for\", \"csvFile\", 1, \"upload-btn\"], [1, \"document-preview-section\"], [1, \"document-preview\"], [1, \"preview-content\"], [3, \"src\", 4, \"ngFor\", \"ngForOf\"], [\"id\", \"csvPreviewContent\", 1, \"preview-content\"], [4, \"ngIf\"], [1, \"preview-section\"], [1, \"preview-header\"], [1, \"download-btn\", 3, \"click\", \"disabled\"], [1, \"table-container\"], [\"id\", \"previewTable\"], [4, \"ngFor\", \"ngForOf\"], [1, \"status-message\", 3, \"ngClass\"], [1, \"progress-bar\"], [1, \"progress\"], [3, \"src\"]],\n      template: function PdfCsvMapperComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"form\")(1, \"div\", 0)(2, \"div\", 1)(3, \"h1\");\n          i0.ɵɵtext(4, \"PDF to CSV Mapper\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(5, \"p\");\n          i0.ɵɵtext(6, \"Upload a PDF and CSV template to extract and map data\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵtemplate(7, PdfCsvMapperComponent_div_7_Template, 2, 2, \"div\", 2);\n          i0.ɵɵelementStart(8, \"div\", 3)(9, \"div\", 4)(10, \"h2\");\n          i0.ɵɵtext(11, \"Upload PDF File\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(12, \"p\");\n          i0.ɵɵtext(13, \"Select the PDF document you want to extract data from\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(14, \"input\", 5);\n          i0.ɵɵlistener(\"change\", function PdfCsvMapperComponent_Template_input_change_14_listener($event) {\n            return ctx.onPdfSelected($event);\n          });\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(15, \"label\", 6);\n          i0.ɵɵtext(16, \"Choose PDF\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(17, \"div\", 7);\n          i0.ɵɵtext(18);\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(19, PdfCsvMapperComponent_div_19_Template, 2, 2, \"div\", 8);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(20, \"div\", 4)(21, \"h2\");\n          i0.ɵɵtext(22, \"Upload CSV/Excel File\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(23, \"p\");\n          i0.ɵɵtext(24, \"Select the CSV or Excel file with headers you want to map to\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(25, \"input\", 9);\n          i0.ɵɵlistener(\"change\", function PdfCsvMapperComponent_Template_input_change_25_listener($event) {\n            return ctx.onCsvSelected($event);\n          });\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(26, \"label\", 10);\n          i0.ɵɵtext(27, \"Choose CSV/Excel\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(28, \"div\", 7);\n          i0.ɵɵtext(29);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(30, \"div\", 11)(31, \"div\", 12)(32, \"h3\");\n          i0.ɵɵtext(33, \"PDF Preview\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(34, \"div\", 13);\n          i0.ɵɵtemplate(35, PdfCsvMapperComponent_img_35_Template, 1, 1, \"img\", 14);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(36, \"div\", 12)(37, \"h3\");\n          i0.ɵɵtext(38, \"CSV Preview\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(39, \"div\", 15);\n          i0.ɵɵtemplate(40, PdfCsvMapperComponent_table_40_Template, 6, 2, \"table\", 16);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(41, \"div\", 17)(42, \"div\", 18)(43, \"h2\");\n          i0.ɵɵtext(44, \"Mapped Data Preview\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(45, \"button\", 19);\n          i0.ɵɵlistener(\"click\", function PdfCsvMapperComponent_Template_button_click_45_listener() {\n            return ctx.downloadExcel();\n          });\n          i0.ɵɵtext(46, \"Download Data as Excel Sheet\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(47, \"div\", 20)(48, \"table\", 21)(49, \"thead\")(50, \"tr\");\n          i0.ɵɵtemplate(51, PdfCsvMapperComponent_th_51_Template, 2, 1, \"th\", 22);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(52, \"tbody\")(53, \"tr\");\n          i0.ɵɵtemplate(54, PdfCsvMapperComponent_td_54_Template, 2, 1, \"td\", 22);\n          i0.ɵɵelementEnd()()()()()()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(7);\n          i0.ɵɵproperty(\"ngIf\", ctx.statusMessage);\n          i0.ɵɵadvance(11);\n          i0.ɵɵtextInterpolate(ctx.pdfFileName || \"No file selected\");\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", ctx.showPdfProgress);\n          i0.ɵɵadvance(10);\n          i0.ɵɵtextInterpolate(ctx.csvFileName || \"No file selected\");\n          i0.ɵɵadvance();\n          i0.ɵɵclassProp(\"has-data\", ctx.documentHasData);\n          i0.ɵɵadvance();\n          i0.ɵɵclassProp(\"has-pdf\", ctx.pageImages.length > 0);\n          i0.ɵɵadvance(4);\n          i0.ɵɵproperty(\"ngForOf\", ctx.pageImages);\n          i0.ɵɵadvance();\n          i0.ɵɵclassProp(\"has-csv\", ctx.csvPreviewHeaders.length > 0);\n          i0.ɵɵadvance(4);\n          i0.ɵɵproperty(\"ngIf\", ctx.csvPreviewHeaders.length > 0);\n          i0.ɵɵadvance();\n          i0.ɵɵclassProp(\"active\", ctx.mappedData.length > 0);\n          i0.ɵɵadvance(4);\n          i0.ɵɵproperty(\"disabled\", ctx.mappedData.length === 0);\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"ngForOf\", ctx.mappedData);\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngForOf\", ctx.mappedData);\n        }\n      },\n      dependencies: [i2.NgClass, i2.NgForOf, i2.NgIf, i3.ɵNgNoValidate, i3.NgControlStatusGroup, i3.NgForm],\n      styles: [\"[_nghost-%COMP%]{font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;color:#333;line-height:1.6}.container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:2rem}.header[_ngcontent-%COMP%]{text-align:center;margin-bottom:2rem;padding-bottom:1rem;border-bottom:1px solid #eee}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:#2c3e50;font-weight:500}.upload-section[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:2rem;margin-bottom:2rem}.upload-card[_ngcontent-%COMP%]{flex:1 1 300px;background:#f9f9f9;border-radius:8px;padding:1.5rem;box-shadow:0 2px 10px #0000001a}.upload-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-top:0;color:#3498db;font-size:1.2rem}.file-input[_ngcontent-%COMP%]{display:none}.upload-btn[_ngcontent-%COMP%]{display:block;padding:.75rem 1.5rem;background:#3498db;color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:1rem;transition:background .3s;text-align:center;margin-top:1rem}.upload-btn[_ngcontent-%COMP%]:hover{background:#2980b9}.file-name[_ngcontent-%COMP%]{margin-top:.5rem;font-size:.9rem;color:#555}.document-preview-section[_ngcontent-%COMP%]{display:none;gap:2rem;margin-bottom:2rem}.document-preview-section.has-data[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.document-preview[_ngcontent-%COMP%]{display:none;flex:1;min-width:300px;background:#fff;border-radius:8px;padding:1rem;box-shadow:0 2px 10px #0000001a;min-height:300px;max-height:500px;overflow-y:auto}.document-preview.has-pdf[_ngcontent-%COMP%], .document-preview.has-csv[_ngcontent-%COMP%]{display:block}.document-preview[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:0;color:#2c3e50;position:sticky;top:0;background:#fff;padding:.5rem 0;z-index:1}.preview-content[_ngcontent-%COMP%]{font-family:monospace;font-size:.9rem}#pdfPreviewContent[_ngcontent-%COMP%]{white-space:pre-wrap}#csvPreviewContent[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-top:1rem}#csvPreviewContent[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], #csvPreviewContent[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.5rem;border:1px solid #ddd;text-align:left}#csvPreviewContent[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f2f2f2;position:sticky;top:40px}#pdfPreviewContent[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;height:auto;display:block;margin:.5rem 0}.preview-section[_ngcontent-%COMP%]{background:#fff;border-radius:8px;padding:1.5rem;margin-top:2rem;box-shadow:0 2px 10px #0000001a;min-height:200px;display:none}.preview-section.active[_ngcontent-%COMP%]{display:block}.preview-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.preview-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;color:#2c3e50}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-top:1rem}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:.75rem;text-align:left;border:1px solid #ddd}th[_ngcontent-%COMP%]{background-color:#f2f2f2;font-weight:600}tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#f9f9f9}.download-btn[_ngcontent-%COMP%]{padding:.75rem 1.5rem;background:#27ae60;color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:1rem;transition:background .3s}.download-btn[_ngcontent-%COMP%]:hover{background:#219653}.download-btn[_ngcontent-%COMP%]:disabled{background:#95a5a6;cursor:not-allowed}.status-message[_ngcontent-%COMP%]{padding:1rem;border-radius:4px;margin-bottom:1rem;display:block}.status-message.success[_ngcontent-%COMP%]{background-color:#d4edda;color:#155724}.status-message.error[_ngcontent-%COMP%]{background-color:#f8d7da;color:#721c24}.progress-bar[_ngcontent-%COMP%]{width:100%;height:6px;background-color:#f1f1f1;margin-top:1rem;border-radius:3px;overflow:hidden}.progress[_ngcontent-%COMP%]{height:100%;background-color:#3498db;width:0%;transition:width .3s ease}@media (max-width: 768px){.upload-section[_ngcontent-%COMP%]{flex-direction:column;gap:1rem}.document-preview[_ngcontent-%COMP%]{min-width:100%}}\"]\n    });\n  }\n  return PdfCsvMapperComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}